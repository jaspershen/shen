---
title: Python模仿ggplot2的绘图包:plotnine
author: Xiaotao Shen
date: 2019-11-27
slug: ''
categories:
 -  Python
tags:
 -  Blog
 -  Chinese
image:
  caption: ''
  focal_point: ''
output:
  blogdown::html_page:
    toc: true
    number_sections: true
---


<div id="TOC">
<ul>
<li><a href="#安装"><span class="toc-section-number">1</span> 安装</a></li>
<li><a href="#使用"><span class="toc-section-number">2</span> 使用</a></li>
</ul>
</div>

<p>Python中有一个模仿R <code>ggplot2</code>语法创建的绘图包,plotnine.官网在这:</p>
<p><a href="https://plotnine.readthedocs.io/en/stable/" class="uri">https://plotnine.readthedocs.io/en/stable/</a></p>
<div id="安装" class="section level1">
<h1><span class="header-section-number">1</span> 安装</h1>
<pre><code>pip install plotinie</code></pre>
</div>
<div id="使用" class="section level1">
<h1><span class="header-section-number">2</span> 使用</h1>
<pre class="python"><code>from plotnine import *
from plotnine.data import mtcars
mtcars.head()</code></pre>
<pre><code>##                 name   mpg  cyl   disp   hp  ...   qsec  vs  am  gear  carb
## 0          Mazda RX4  21.0    6  160.0  110  ...  16.46   0   1     4     4
## 1      Mazda RX4 Wag  21.0    6  160.0  110  ...  17.02   0   1     4     4
## 2         Datsun 710  22.8    4  108.0   93  ...  18.61   1   1     4     1
## 3     Hornet 4 Drive  21.4    6  258.0  110  ...  19.44   1   0     3     1
## 4  Hornet Sportabout  18.7    8  360.0  175  ...  17.02   0   0     3     2
## 
## [5 rows x 12 columns]</code></pre>
<p>需要注意的是,在python中,<code>+</code>要放在每一句的前面而不是后面.</p>
<pre class="python"><code>(ggplot(mtcars, aes(&#39;wt&#39;, &#39;mpg&#39;, color=&#39;factor(gear)&#39;))
 + geom_point()
 + stat_smooth(method=&#39;lm&#39;)
 + facet_wrap(&#39;~gear&#39;))</code></pre>
<pre><code>## &lt;ggplot: (-9223372036762410300)&gt;
## 
## D:\software\python\lib\site-packages\plotnine\scales\scale.py:93: MatplotlibDeprecationWarning: 
## The iterable function was deprecated in Matplotlib 3.1 and will be removed in 3.3. Use np.iterable instead.
##   if cbook.iterable(self.breaks) and cbook.iterable(self.labels):
## D:\software\python\lib\site-packages\numpy\core\fromnumeric.py:2389: FutureWarning: Method .ptp is deprecated and will be removed in a future version. Use numpy.ptp instead.
##   return ptp(axis=axis, out=out, **kwargs)
## D:\software\python\lib\site-packages\numpy\core\fromnumeric.py:2389: FutureWarning: Method .ptp is deprecated and will be removed in a future version. Use numpy.ptp instead.
##   return ptp(axis=axis, out=out, **kwargs)
## D:\software\python\lib\site-packages\numpy\core\fromnumeric.py:2389: FutureWarning: Method .ptp is deprecated and will be removed in a future version. Use numpy.ptp instead.
##   return ptp(axis=axis, out=out, **kwargs)
## D:\software\python\lib\site-packages\plotnine\utils.py:553: MatplotlibDeprecationWarning: 
## The iterable function was deprecated in Matplotlib 3.1 and will be removed in 3.3. Use np.iterable instead.
##   return cbook.iterable(var) and not is_string(var)</code></pre>
<p><img src="/en/post/2019-11-27-plotnine/index_files/figure-html/unnamed-chunk-2-1.png" width="614" /></p>
<p>可以看到跟<code>ggplot2</code>语法几乎一致,非常方便,大大减小了学习成本.</p>
<p>当然也可以将生成的图片赋值给变量.</p>
<pre class="python"><code>plot = (ggplot(mtcars)
+ geom_point(aes(x = &quot;wt&quot;, y = &quot;mpg&quot;, colour = &quot;gear&quot;))
+ theme_bw()
)
plot</code></pre>
<pre><code>## &lt;ggplot: (-9223372036754654152)&gt;
## 
## D:\software\python\lib\site-packages\plotnine\scales\scale.py:93: MatplotlibDeprecationWarning: 
## The iterable function was deprecated in Matplotlib 3.1 and will be removed in 3.3. Use np.iterable instead.
##   if cbook.iterable(self.breaks) and cbook.iterable(self.labels):
## D:\software\python\lib\site-packages\plotnine\utils.py:553: MatplotlibDeprecationWarning: 
## The iterable function was deprecated in Matplotlib 3.1 and will be removed in 3.3. Use np.iterable instead.
##   return cbook.iterable(var) and not is_string(var)</code></pre>
<p><img src="/en/post/2019-11-27-plotnine/index_files/figure-html/unnamed-chunk-3-1.png" width="614" /></p>
<p><strong>但是需要注意</strong>:</p>
<p>从<code>ggplot</code>开始,到绘图代码结束,都需要放在一个小括号里面.</p>
<p>语法跟ggplot2几乎是相同的,真的是非常方便了!!</p>
<p>当然,问题也是有的,就是没有像R中一样的,<code>ggplot2</code>的扩展包了,比如<code>ggraph</code>等.</p>
</div>
